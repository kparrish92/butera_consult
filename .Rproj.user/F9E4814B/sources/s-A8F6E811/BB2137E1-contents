# A script to analyze the relationship between relative intensity (RI) per 
# region/dialect of Spanish

# Libraries 

library(here)
library(tidyverse)
library(lme4)
library(lmerTest)

# Load data 

raw_data <- read.csv(here("data", "raw_data.csv"))

# Run nested model comparison 

mod0 = lmer(Relative.intensity ~ 1 + (1 | Speaker), data = raw_data)

mod1 = lmer(Relative.intensity ~ Region*Sonority + (1 | Speaker), 
            data = raw_data)
mod2 = lmer(Relative.intensity ~ Region + 
              Phoneme + (1 | Speaker), data = raw_data)
mod3 = lmer(Relative.intensity ~ Region* 
              Phoneme + (1 | Speaker), data = raw_data)




anova(mod0, mod1)


summary(mod1)
summary(mod3)


## Results 

# Claim: There is a difference in point of articulation per RI per variety 

pot_var_0 = lmer(Relative.intensity ~ 1 + (1 | Speaker), data = raw_data)
pot_var_1 = lmer(Relative.intensity ~ 1 + Region + 
                   (1 | Speaker), data = raw_data)
pot_var_2 = lmer(Relative.intensity ~ 1 + Point.of.articulation + Region + 
                   (1 | Speaker), data = raw_data)
pot_var_3 = lmer(Relative.intensity ~ 1 + Point.of.articulation*Region + 
                   (1 | Speaker), data = raw_data)
pot_var_4 = lmer(Relative.intensity ~ 1 + Point.of.articulation*Region + Sonority + 
                   (1 | Speaker), data = raw_data)
pot_var_5 = lmer(Relative.intensity ~ 1 + Point.of.articulation + Region*Sonority + 
                 (1 | Speaker), data = raw_data)
pot_var_6 = lmer(Relative.intensity ~ 1 + Point.of.articulation*Region*Sonority +
                   (1 | Speaker), data = raw_data)

anova(pot_var_0, pot_var_1, pot_var_2, pot_var_3, pot_var_4, pot_var_5, pot_var_6)

summary(pot_var_6)

# There is not evidence that RI by region depends upon phoneme  

# 

RI varies by region overall - main eff of region 
RI varies by sonority overall - main eff of sonority 

Whether each region sees differences in RI by phoneme  - place of articulation 

RI varies as a function of stress and sonority

RI varies by following vowel frontness

RI varies by following vowel height

mod_0 = lmer(Relative.intensity ~ 1 + (1 | Speaker), data = raw_data)
mod_1 = lmer(Relative.intensity ~ Region + (1 | Speaker), data = raw_data)
mod_2 = lmer(Relative.intensity ~ Region + Sonority + (1 | Speaker), data = raw_data)
mod_3 = lmer(Relative.intensity ~ Region + Sonority + Point.of.articulation + 
               (1 | Speaker), data = raw_data)
mod_4 = lmer(Relative.intensity ~ Region + Sonority + Point.of.articulation + Stress +
               (1 | Speaker), data = raw_data)
mod_5 = lmer(Relative.intensity ~ Region + Sonority + Point.of.articulation + Stress +
               Horizontal.position +
               (1 | Speaker), data = raw_data)
mod_6 = lmer(Relative.intensity ~ Region + Sonority + Point.of.articulation + Stress +
               Horizontal.position + Vertical.Position +
             (1 | Speaker), data = raw_data)


nmc_obj <- anova(mod_0, mod_1, mod_2, mod_3, mod_4, mod_5, mod_6)

summary(mod_7)
raw_data$
  
fe_df = fixef(mod_9) %>% as.data.frame()
